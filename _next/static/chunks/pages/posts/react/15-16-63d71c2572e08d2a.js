(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7374],{87562:(e,i,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/react/15-16",function(){return r(57325)}])},57325:(e,i,r)=>{"use strict";r.r(i),r.d(i,{default:()=>h,useTOC:()=>a});var n=r(86070),s=r(19422),l=r(72522),c=r(24756);let t={src:"/_next/static/media/hero.1de8efd3.webp",height:900,width:1200,blurDataURL:"data:image/webp;base64,UklGRl4AAABXRUJQVlA4IFIAAADQAQCdASoIAAYAAkA4JZQCdAED+Vl3eAD+9+HjV0/z6MSbpRV2Y3z1cP/Y7MXT4Y3iXEYqBWJmK7ael9Bxs6kJPIiX7bP+iDf5McgK5XAtwAAA",blurWidth:8,blurHeight:6};r(88564);var d=r(39942);function a(e){return[{value:"结构",id:"结构",depth:2},{value:"react15的架构可以分为两层：",id:"react15的架构可以分为两层",depth:3},{value:"react16的架构可以分为三层：",id:"react16的架构可以分为三层",depth:3},{value:"区别",id:"区别",depth:2}]}let h=(0,s.e)(function(e){let{toc:i=a(e)}=e,r={code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"15 16",placeholder:"blur",src:t})}),"\n",(0,n.jsx)("div",{className:"img-desc",children:"图：Amrit Pal Singh"}),"\n","\n",(0,n.jsx)(r.h2,{id:i[0].id,children:i[0].value}),"\n",(0,n.jsx)(r.h3,{id:i[1].id,children:i[1].value}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Reconciler（协调器）— 找出需要更新的组件，以及标识出如何更新"}),"\n",(0,n.jsx)(r.li,{children:"Renderer（渲染器）— 负责将变化后的组件渲染到页面上"}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:i[2].id,children:i[2].value}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Scheduler（调度器）— 调度任务的优先级，高级优先级的优先进入Reconciler阶段"}),"\n",(0,n.jsx)(r.li,{children:"Reconciler（协调器）— 找出需要更新的组件，以及标识出如何更新"}),"\n",(0,n.jsx)(r.li,{children:"Renderer（渲染器）— 负责将变化后的组件渲染到页面上"}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"浏览器的16.6ms机制"}),"\n",(0,n.jsx)(r.p,{children:"对人眼来说，正常流畅的刷新率为60hz，即60帧，即浏览器16.6ms刷新一次。"}),"\n",(0,n.jsx)(r.p,{children:"我们知道js可以操作dom元素，所以浏览器的GUI线程和js线程是互斥的。js的执行和浏览器的绘制、布局不能同时进行。所以在每16.6ms内浏览器要执行如下操作："}),"\n",(0,n.jsx)(r.pre,{icon:d.js,tabIndex:"0","data-language":"js","data-word-wrap":"","data-copy":"",children:(0,n.jsx)(r.code,{children:(0,n.jsxs)(r.span,{children:[(0,n.jsx)(r.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:"JS"}),(0,n.jsx)(r.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"脚本执行 "}),(0,n.jsx)(r.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"------"}),(0,n.jsx)(r.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" 浏览器样式布局 "}),(0,n.jsx)(r.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"------"}),(0,n.jsx)(r.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" 浏览器样式绘制"})]})})}),"\n",(0,n.jsx)(r.p,{children:"如果js脚本执行时间过长，超过16.6ms，这次刷新中浏览器绘制和布局就无法执行，这就会造成人眼可识别的卡顿，发现操作时浏览器没有“实时”做出反应。如：对于用户在输入框输入内容这个行为来说，就体现为按下了键盘按键但是页面上不实时显示输入。"}),"\n",(0,n.jsx)(r.h2,{id:i[3].id,children:i[3].value}),"\n",(0,n.jsx)(r.p,{children:"react15的reconciler是stack-reconciler。"}),"\n",(0,n.jsx)(r.p,{children:"即是采用递归形式工作的，是同步的，在生成虚拟dom树并diff过程中是无法中断的。"}),"\n",(0,n.jsx)(r.p,{children:"这样在组件层级过深时，会造成js执行时间过长，浏览器无法布局和绘制，造成丢帧。"}),"\n",(0,n.jsx)(r.p,{children:"react16的reconciler是fiber-reconciler。"}),"\n",(0,n.jsx)(r.p,{children:"即采用的异步可中断更新代替react15的同步更新，react16的scheduler调度器会告诉reconciler，浏览器是否有空闲时间执行js脚本。"}),"\n",(0,n.jsx)(r.p,{children:"这样就不会影响浏览器的绘制和布局工作。不会丢帧。"}),"\n",(0,n.jsx)(r.p,{children:"在react16中，原来的虚拟DOM,因其结构已不能满足异步可中断更新的需求，改而采用新的结构Fiber。"}),"\n",(0,n.jsx)(r.p,{children:"虚拟dom节对应变为Fiber节点，虚拟dom树对应变为Fiber树。"})]})},"/posts/react/15-16",{filePath:"pages/posts/react/15-16/index.mdx",timestamp:1732442721e3,pageMap:l.O,frontMatter:{slug:"react-15-16",title:"React 15 和 React 16 的区别",author:"Favori",date:"2021-10-06",hero:"./hero.webp",excerpt:"react-15-16"},title:"React 15 和 React 16 的区别"},"undefined"==typeof RemoteContent?a:RemoteContent.useTOC)},88564:(e,i,r)=>{"use strict";r.d(i,{A:()=>s});var n=r(86070);r(30758);let s=e=>{let{name:i}=e;return(0,n.jsx)("img",{src:"http://github.com/yuanguandong/code/blob/master/draw/".concat(i,".png?raw=true")})}}},e=>{var i=i=>e(e.s=i);e.O(0,[2195,636,6593,8792],()=>i(87562)),_N_E=e.O()}]);