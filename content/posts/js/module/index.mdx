---
slug: module
title: å„ç§JSæ¨¡å—åŒ–ç‰¹æ€§
author: ygd
date: 2020-05-30
hero: ./hero.webp
excerpt: AMDã€CMDã€CJSã€ESM
---
<div className={'img-desc'}>å›¾ï¼šNguyen Nhut</div>


# AMD

AMD çš„ä»£è¡¨è‚¯å®šå°±æ˜¯å¤§åé¼é¼çš„ RequireJS

James Burke è§‰å¾— CMJ å¾ˆå¥½ï¼Œä½†æ˜¯åœ¨æµè§ˆå™¨é‡Œç©ä¸è½¬ï¼Œæ‰€ä»¥è‡ªå·±æå‡ºäº†ä¸€ä¸ª AMD è§„èŒƒ

### AMD Usage

```js
define(id?, depencies?, factory);

define('foo', ['utils', 'bar'], function(utils, bar) {
  utils.add(1, 2);
  return {
    name: 'foo'
  }
})
```

### å®ç°ä¸€ä¸ªç¬¦åˆ AMD çš„ rj.js

åªæ˜¯æ ¸å¿ƒèƒ½åŠ›ä½œä¸ºå®ç°ï¼Œå…·ä½“ï¼šhttps://requirejs.org/docs/api.html

1. å¯ä»¥ç›´æ¥é…ç½®ä¾èµ–è·¯å¾„

```js
rj.config({ paths: {
  'jquery': 'https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js'
} });

rj(['jquery'], function(jquery) {
  // ....
})
```

2. åŠ è½½æ¨¡å—

```js
// RequestJs('')
rj(['moduleA'], function(moduleA) {});
```

3. å®šä¹‰æ¨¡å—

```js
rj('moduleA', [], function() {
  return 'hello zhuawa!';
})
```

### è¡Œä¸º

```js
// RequireJS
define('a', function () {
  console.log('a load')
  return {
    run: function () { console.log('a run') }
  }
})

define('b', function () {
  console.log('b load')
  return {
    run: function () { console.log('b run') }
  }
})

require(['a', 'b'], function (a, b) {
  console.log('main run') // ğŸ”¥
  a.run()
  b.run()
})

// a load
// b load
// main run
// a run
// b run
```

è®°å½•ä¸€ä¸‹ï¼š
1. require çš„æ—¶å€™åŠ è½½äº†ä¾èµ–çš„æ¨¡å—

ä¸€äº›å¯ä»¥ç”¨æ¥æµ‹è¯•çš„ CDN åœ°å€
systemjs -> https://cdn.bootcdn.net/ajax/libs/systemjs/6.8.3/system.min.js
lodash -> https://cdn.bootcdn.net/ajax/libs/lodash.js/4.17.21/lodash.min.js


# CMD

ä»£è¡¨äººç‰©ç‰ä¼¯ï¼Œä»£è¡¨æŠ€æœ¯å®ç° Seajs

### Usage

```js
// sea.js
define('a', function (require, exports, module) {
  console.log('a load')
  exports.run = function () { console.log('a run') }
})

define('b', function (require, exports, module) {
  console.log('b load')
  exports.run = function () { console.log('b run') }
})

define('main', function (require, exports, module) {
  console.log('main run')
  var a = require('a')
  a.run()
  var b = require('b')
  b.run()
})

seajs.use('main')

// main run
// a load
// a run
// b load
// b run
```

# COMMONJS

æ–‡ä»¶æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œç§æœ‰ã€‚å†…ç½®ä¸¤ä¸ªå˜é‡ module require (exports = module.exports)

ä¸€ä¸ªå¼•å…¥ä¸€ä¸ªå¯¼å‡ºï¼Œå°±æ„æˆäº†é€šä¿¡çš„åŸºæœ¬ç»“æ„

### éœ€è¦æ³¨æ„çš„ä¸¤ä¸ªé—®é¢˜

1. ç¼“å­˜ï¼Œrequire ä¼šç¼“å­˜ä¸€ä¸‹ï¼Œæ‰€ä»¥

```js
// a.js
var name = 'morrain'
var age = 18
exports.name = name
exports.getAge = function(){
    return age
}
// b.js
var a = require('a.js')
console.log(a.name) // 'morrain'
a.name = 'rename'
var b = require('a.js')
console.log(b.name) // 'rename'
```

2. å¼•ç”¨æ‹·è´è¿˜æ˜¯å€¼æ‹·è´çš„é—®é¢˜(CMJ æ˜¯å€¼æ‹·è´)

```js
// a.js
var name = 'morrain'
var age = 18
exports.name = name
exports.age = age
exports.setAge = function(a){
    age = a
}
// b.js
var a = require('a.js')
console.log(a.age) // 18
a.setAge(19)
console.log(a.age) // 18
```

3. è¿è¡Œæ—¶åŠ è½½ / ç¼–è¯‘æ—¶åŠ è½½ï¼ˆå¤šé˜¶æ®µï¼Œå¼‚æ­¥ï¼‰ESM


# ESM
æˆ‘ä»¬æ‰€è¯´çš„esModuleå…¶å®å°±æ˜¯es6æ¨å‡ºçš„javascriptæ¨¡å—è§„èŒƒã€‚åœ¨è¿™ä¹‹å‰ç”±äºæ²¡æœ‰è§„èŒƒæ‰€ä»¥ç¤¾åŒºæ¨å‡ºäº†CommonJSè§„èŒƒã€require.jsç­‰ã€‚esModuleçš„è¯­æ³•æ˜¯é™æ€çš„ã€å¯¼å‡ºæ˜¯ç»‘å®šçš„

ä»€ä¹ˆæ˜¯é™æ€ï¼Ÿ
é™æ€çš„è¯­æ³•æ„å‘³ç€å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç¡®å®šå¯¼å…¥å’Œå¯¼å‡ºï¼Œæ›´åŠ å¿«é€Ÿçš„æŸ¥æ‰¾ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨lintå·¥å…·å¯¹æ¨¡å—ä¾èµ–è¿›è¡Œæ£€æŸ¥ï¼Œå¯ä»¥å¯¹å¯¼å…¥å¯¼å‡ºåŠ ä¸Šç±»å‹ä¿¡æ¯è¿›è¡Œé™æ€çš„ç±»å‹æ£€æŸ¥

ä»€ä¹ˆæ˜¯å¯¼å‡ºç»‘å®šï¼Ÿ
ç”±äºä½¿ç”¨importå¯¼å…¥çš„æ¨¡å—æ˜¯è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹çš„ï¼Œä¸”å‡ä¸ºåªè¯»çš„(å³æ— æ³•è¢«èµ‹å€¼ã€‚ä½†æ˜¯å¯ä»¥æ›´æ”¹å±æ€§),ä¸”å‡ä¸ºå¼•ç”¨ä¼ é€’ï¼Œæ— å…³ç±»å‹ï¼Œå‡æ˜¯ä¸åŸå˜é‡çš„å¼•ç”¨ã€‚


å¯¼å‡º export
```js
// ep.js
// æœ€å¸¸ç”¨çš„å¤§æ¦‚å°±æ˜¯å£°æ˜å‘½åå¯¼å‡ºäº†
export const name = 'bababa' // var let const function class å‡å¯
// é»˜è®¤å¯¼å‡º
export default constant
export default function() {}
export { constant as default } // é‡å‘½åé»˜è®¤å¯¼å‡º
// å‘½åå¯¼å‡º
export { ep1, ep2, ep3 }
export { ep1 as _ep1, ep2 as _ep2, ep3 as _ep3 } // é‡å‘½åå¯¼å‡º
// é‡å®šå‘å¯¼å‡º
export * from 'action' // é‡å®šå‘å¯¼å‡º(å¯¼å‡ºä¸åŒ…å«æ¨¡å—å†…çš„defaultçš„æ‰€æœ‰)ï¼Œé‡å®šå‘çš„å‘½åå¹¶ä¸èƒ½åœ¨æœ¬æ¨¡å—ä½¿ç”¨ï¼Œåªæ˜¯æ­å»ºä¸€ä¸ªæ¡¥æ¢ã€‚
// ä¸‹é¢æ˜¯å‡ ä¸ªé”™è¯¯èŒƒä¾‹
export 1
const $ep = 1
export $ep
```
å¯¼å…¥ import
```js
// å‘½åå¯¼å…¥
import { ep1, ep2, ep3 } from './ep'
// é‡å‘½åå¯¼å…¥
import { ep1 as _ep1, ep2 as _ep2, ep3 as _ep3 } from './ep'
// æ··åˆå¯¼å…¥
import * as ep from './ep'
import default,  { ep1, ep2, ep3 as $ep3 } from './ep'
// effect æ‰§è¡Œ  å¤šæ¬¡å¼•å…¥ä¹Ÿåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæœ‰ç‚¹åƒphpé‡Œçš„include_once
import './ep'
// åŠ¨æ€å¯¼å…¥
import('./ep').then()

// ä¸‹é¢æ˜¯å‡ ä¸ªé”™è¯¯èŒƒä¾‹
import { 'ep1' + 'ep2' } from './ep' // importæ˜¯ç¼–è¯‘é˜¶æ®µï¼Œæ‰€ä»¥ä¸èƒ½åŠ¨æ€åŠ è½½
```
 -->
